<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Echo Seven – Follow on Apple Music or Spotify</title>
  <meta property="og:title" content="Echo Seven – Artist Page" />
  <meta property="og:description" content="Follow Echo Seven on your favourite music service." />
  <meta property="og:type" content="website" />
  <meta name="twitter:card" content="summary" />
  <style>
    :root { color-scheme: dark; }
    body { font-family: system-ui,-apple-system,Segoe UI,Roboto,Helvetica,Arial,sans-serif; background:#0b0b0b; color:#fff; display:flex; justify-content:center; align-items:center; min-height:100vh; margin:0; padding:24px; }
    .card { background:#121212; padding:28px; border-radius:16px; box-shadow:0 10px 30px rgba(0,0,0,.35); max-width:760px; text-align:center; }
    h1 { font-size:28px; margin:0 0 10px; }
    p.lead { opacity:.9; margin:0 0 16px; }
    .btns { display:flex; gap:12px; flex-wrap:wrap; justify-content:center; margin-top:8px; }
    .btn { padding:14px 18px; border-radius:999px; font-weight:700; text-decoration:none; border:0; cursor:pointer; }
    .btn-apple { background:#fff; color:#000; }
    .btn-spotify { background:#1DB954; color:#000; }
    .btn-preview { background:#2a2a2a; color:#fff; }
    .small { font-size:12px; opacity:.7; margin-top:12px; }
    .teaser { margin-top:16px; }
    iframe.teaser-embed { margin-top:12px; border-radius:12px; width:100%; max-width:660px; }
    .hide { display:none !important; }
  </style>

  <!-- Meta Pixel -->
  <script>
    !(function(f,b,e,v,n,t,s){if(f.fbq)return;n=f.fbq=function(){n.callMethod?
    n.callMethod.apply(n,arguments):n.queue.push(arguments)};if(!f._fbq)f._fbq=n;
    n.push=n;n.loaded=!0;n.version='2.0';n.queue=[];t=b.createElement(e);t.async=!0;
    t.src=v;s=b.getElementsByTagName(e)[0];s.parentNode.insertBefore(t,s)})(window,document,'script','https://connect.facebook.net/en_US/fbevents.js');
    fbq('init', '3718618815109659');
    fbq('track', 'PageView');
  </script>
  <noscript><img height="1" width="1" style="display:none" src="https://www.facebook.com/tr?id=3718618815109659&ev=PageView&noscript=1" /></noscript>

  <script>
    // --- Config ---
    const cfg = {
      utm: "utm_source=ad&utm_medium=landing&utm_campaign=echo_seven_follow",
      spotifyArtistId: "1xdDfEI9pjuEXglEaK8k4u",
      appleArtistFullUrl: "https://music.apple.com/gb/artist/echo-seven/1827674820",
      spotifyTrackId: "1Non9dMlsEcC5Mavv684al",
      appleAlbumTrackEmbed: "https://embed.music.apple.com/gb/album/latitude-daze-euro-disco-mix/1827825001?i=1827825008"
    };

    // --- Environment detection ---
    const UA = navigator.userAgent || navigator.vendor || window.opera || "";
    const isIPadOSDesktop = /Macintosh/i.test(UA) && (("ontouchend" in document) || (navigator.maxTouchPoints>1));
    const isIOS = /iPad|iPhone|iPod/i.test(UA) || isIPadOSDesktop;
    const isAndroid = /Android/i.test(UA);

    function appendUtm(url){ return cfg.utm ? `${url}${url.includes('?') ? '&' : '?'}${cfg.utm}` : url; }

    // --- Follow handlers ---
    function openSpotify(){
      try{ fbq('trackCustom','FollowClick',{service:'spotify'}); }catch(e){}
      const appUri = `spotify://artist/${cfg.spotifyArtistId}`;
      const webUrl = appendUtm(`https://open.spotify.com/artist/${cfg.spotifyArtistId}`);
      if (/iPad|iPhone|iPod|Macintosh/.test(UA)){
        const t = Date.now();
        try{ location.href = appUri; }catch(e){}
        setTimeout(()=>{ if (Date.now()-t < 1500) location.replace(webUrl); }, 800);
      } else if (isAndroid){
        const intent = `intent://artist/${cfg.spotifyArtistId}#Intent;scheme=spotify;package=com.spotify.music;S.browser_fallback_url=${encodeURIComponent(webUrl)};end`;
        location.href = intent;
      } else {
        location.href = webUrl;
      }
    }

    function openApple(){
      try{ fbq('trackCustom','FollowClick',{service:'apple'}); }catch(e){}
      const url = appendUtm(cfg.appleArtistFullUrl);
      if (isAndroid){
        const intent = `intent://${url.replace(/^https:\\/\\//,'')}#Intent;scheme=https;package=com.apple.android.music;S.browser_fallback_url=${encodeURIComponent(url)};end`;
        location.href = intent;
      } else {
        location.href = url;
      }
    }

    // --- Teaser preview (lazy render on click; no HTML5 fallback) ---
    function renderPreview(){
      const mount = document.getElementById('teaserMount');
      if (!mount || mount.dataset.loaded) return;
      mount.dataset.loaded = '1';
      try{ fbq('trackCustom','TeaserOpen',{platform: isIOS ? 'iOS' : isAndroid ? 'Android' : 'Desktop'}); }catch(e){}
      let html;
      if (isIOS){
        html = `<iframe class="teaser-embed" allow="autoplay *; encrypted-media *; fullscreen *" frameborder="0" height="175"
                 sandbox="allow-forms allow-popups allow-same-origin allow-scripts allow-top-navigation-by-user-activation"
                 src="${cfg.appleAlbumTrackEmbed}"></iframe>`;
      } else {
        html = `<iframe class="teaser-embed" src="https://open.spotify.com/embed/track/${cfg.spotifyTrackId}"
                 height="152" frameborder="0" allow="autoplay; clipboard-write; encrypted-media; fullscreen; picture-in-picture" loading="lazy"></iframe>`;
      }
      mount.innerHTML = html;
      document.getElementById('previewBtn').classList.add('hide');
    }

    document.addEventListener('DOMContentLoaded', ()=>{
      document.getElementById('btnApple').addEventListener('click', openApple);
      document.getElementById('btnSpotify').addEventListener('click', openSpotify);
      document.getElementById('previewBtn').addEventListener('click', renderPreview);
      // Auto-redirect disabled by request.
    });
  </script>
</head>
<body>
  <div class="card">
    <h1>Follow Echo Seven</h1>
    <p class="lead">Tap a service to follow. Want a taste first? Play a short preview.</p>

    <div class="btns">
      <button id="btnApple" class="btn btn-apple">Follow on Apple Music</button>
      <button id="btnSpotify" class="btn btn-spotify">Follow on Spotify</button>
      <button id="previewBtn" class="btn btn-preview">▶︎ Play preview</button>
    </div>

    <div id="teaserMount" class="teaser" aria-live="polite"></div>

    <p class="small">Direct links:
      <a href="https://music.apple.com/gb/artist/echo-seven/1827674820">Apple Music</a> ·
      <a href="https://open.spotify.com/artist/1xdDfEI9pjuEXglEaK8k4u">Spotify</a>
    </p>
  </div>
</body>
</html>
